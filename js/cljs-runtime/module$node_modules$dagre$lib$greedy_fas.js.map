{
"version":3,
"file":"module$node_modules$dagre$lib$greedy_fas.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/dagre/lib/greedy-fas.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$dagre$lib$greedy_fas\"] = function(global,require,module,exports) {\nvar _ = require(\"./lodash\");\nvar Graph = require(\"./graphlib\").Graph;\nvar List = require(\"./data/list\");\n\n/*\n * A greedy heuristic for finding a feedback arc set for a graph. A feedback\n * arc set is a set of edges that can be removed to make a graph acyclic.\n * The algorithm comes from: P. Eades, X. Lin, and W. F. Smyth, \"A fast and\n * effective heuristic for the feedback arc set problem.\" This implementation\n * adjusts that from the paper to allow for weighted edges.\n */\nmodule.exports = greedyFAS;\n\nvar DEFAULT_WEIGHT_FN = _.constant(1);\n\nfunction greedyFAS(g, weightFn) {\n  if (g.nodeCount() <= 1) {\n    return [];\n  }\n  var state = buildState(g, weightFn || DEFAULT_WEIGHT_FN);\n  var results = doGreedyFAS(state.graph, state.buckets, state.zeroIdx);\n\n  // Expand multi-edges\n  return _.flatten(_.map(results, function(e) {\n    return g.outEdges(e.v, e.w);\n  }), true);\n}\n\nfunction doGreedyFAS(g, buckets, zeroIdx) {\n  var results = [];\n  var sources = buckets[buckets.length - 1];\n  var sinks = buckets[0];\n\n  var entry;\n  while (g.nodeCount()) {\n    while ((entry = sinks.dequeue()))   { removeNode(g, buckets, zeroIdx, entry); }\n    while ((entry = sources.dequeue())) { removeNode(g, buckets, zeroIdx, entry); }\n    if (g.nodeCount()) {\n      for (var i = buckets.length - 2; i > 0; --i) {\n        entry = buckets[i].dequeue();\n        if (entry) {\n          results = results.concat(removeNode(g, buckets, zeroIdx, entry, true));\n          break;\n        }\n      }\n    }\n  }\n\n  return results;\n}\n\nfunction removeNode(g, buckets, zeroIdx, entry, collectPredecessors) {\n  var results = collectPredecessors ? [] : undefined;\n\n  _.forEach(g.inEdges(entry.v), function(edge) {\n    var weight = g.edge(edge);\n    var uEntry = g.node(edge.v);\n\n    if (collectPredecessors) {\n      results.push({ v: edge.v, w: edge.w });\n    }\n\n    uEntry.out -= weight;\n    assignBucket(buckets, zeroIdx, uEntry);\n  });\n\n  _.forEach(g.outEdges(entry.v), function(edge) {\n    var weight = g.edge(edge);\n    var w = edge.w;\n    var wEntry = g.node(w);\n    wEntry[\"in\"] -= weight;\n    assignBucket(buckets, zeroIdx, wEntry);\n  });\n\n  g.removeNode(entry.v);\n\n  return results;\n}\n\nfunction buildState(g, weightFn) {\n  var fasGraph = new Graph();\n  var maxIn = 0;\n  var maxOut = 0;\n\n  _.forEach(g.nodes(), function(v) {\n    fasGraph.setNode(v, { v: v, \"in\": 0, out: 0 });\n  });\n\n  // Aggregate weights on nodes, but also sum the weights across multi-edges\n  // into a single edge for the fasGraph.\n  _.forEach(g.edges(), function(e) {\n    var prevWeight = fasGraph.edge(e.v, e.w) || 0;\n    var weight = weightFn(e);\n    var edgeWeight = prevWeight + weight;\n    fasGraph.setEdge(e.v, e.w, edgeWeight);\n    maxOut = Math.max(maxOut, fasGraph.node(e.v).out += weight);\n    maxIn  = Math.max(maxIn,  fasGraph.node(e.w)[\"in\"]  += weight);\n  });\n\n  var buckets = _.range(maxOut + maxIn + 3).map(function() { return new List(); });\n  var zeroIdx = maxIn + 1;\n\n  _.forEach(fasGraph.nodes(), function(v) {\n    assignBucket(buckets, zeroIdx, fasGraph.node(v));\n  });\n\n  return { graph: fasGraph, buckets: buckets, zeroIdx: zeroIdx };\n}\n\nfunction assignBucket(buckets, zeroIdx, entry) {\n  if (!entry.out) {\n    buckets[0].enqueue(entry);\n  } else if (!entry[\"in\"]) {\n    buckets[buckets.length - 1].enqueue(entry);\n  } else {\n    buckets[entry.out - entry[\"in\"] + zeroIdx].enqueue(entry);\n  }\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","doGreedyFAS","g","buckets","zeroIdx","results","sources","length","sinks","entry","nodeCount","dequeue","removeNode","i","concat","collectPredecessors","undefined","_","forEach","inEdges","v","edge","weight","uEntry","node","push","w","out","assignBucket","outEdges","wEntry","buildState","weightFn","fasGraph","Graph","maxIn","maxOut","nodes","setNode","edges","e","prevWeight","setEdge","Math","max","range","map","List","graph","enqueue","greedyFAS","state","DEFAULT_WEIGHT_FN","flatten","constant"]
}
