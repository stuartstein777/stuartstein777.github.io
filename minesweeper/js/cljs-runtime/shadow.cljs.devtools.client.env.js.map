{"version":3,"sources":["shadow/cljs/devtools/client/env.cljs"],"mappings":"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","names":["js/shadow","js/shadow.cljs","js/shadow.cljs.devtools","js/shadow.cljs.devtools.client","js/shadow.cljs.devtools.client.env","js/shadow.cljs.devtools.client.env.active-modules-ref","shadow.cljs.devtools.client.env/active-modules-ref","cljs.core/volatile!","shadow.cljs.devtools.client.env/module-loaded","name","cljs.core.conj","cljs.core.keyword","shadow.cljs.devtools.client.env/module-is-active?","module","cljs.core/deref","cljs.core/contains?","js/shadow.cljs.devtools.client.env.runtime-id","shadow.cljs.devtools.client.env/runtime-id","cljs.core/random-uuid","js/goog.define","shadow.cljs.devtools.client.env/enabled","shadow.cljs.devtools.client.env/autoload","shadow.cljs.devtools.client.env/module-format","shadow.cljs.devtools.client.env/reload-with-state","shadow.cljs.devtools.client.env/build-id","shadow.cljs.devtools.client.env/proc-id","shadow.cljs.devtools.client.env/server-host","shadow.cljs.devtools.client.env/server-port","shadow.cljs.devtools.client.env/repl-pprint","shadow.cljs.devtools.client.env/use-document-host","shadow.cljs.devtools.client.env/devtools-url","shadow.cljs.devtools.client.env/reload-strategy","shadow.cljs.devtools.client.env/ssl","shadow.cljs.devtools.client.env/ignore-warnings","shadow.cljs.devtools.client.env/log-style","shadow.cljs.devtools.client.env/custom-notify-fn","shadow.cljs.devtools.client.env/devtools-info","shadow.cljs.devtools.client.env/get-server-host","and__4115__auto__","js/goog.global.document","js/goog.global.document.location","cljs.core/seq","js/goog.global.document.location.hostname","js/document.location.hostname","shadow.cljs.devtools.client.env/get-url-base","shadow.cljs.devtools.client.env/get-ws-url-base","clojure.string/replace","js/Error","shadow.cljs.devtools.client.env/ws-url","runtime-type","cljs.core/Keyword","cljs.core/name","shadow.cljs.devtools.client.env/ws-listener-url","client-type","shadow.cljs.devtools.client.env/files-url","shadow.cljs.devtools.client.env/repl-print-fn","cljs.core/pr-str","obj","sb__4667__auto__","goog.string/StringBuffer","*print-newline*-orig-val__40452","cljs.core/*print-newline*","*print-fn*-orig-val__40453","cljs.core/*print-fn*","*print-newline*-temp-val__40454","*print-fn*-temp-val__40455","x__4668__auto__","cljs.pprint.pprint","shadow.cljs.devtools.client.env/repl-error","e","G__40459","cljs.core.assoc","js/shadow.cljs.devtools.client.env.repl-results-ref","shadow.cljs.devtools.client.env/repl-results-ref","cljs.core.atom","shadow.cljs.devtools.client.env/repl-call","repl-expr","repl-error","e40465","result-id","result","start","js/Date.now","ret","runtime","cljs.core.swap_BANG_","cljs.core/assoc","cljs.core/*3","cljs.core/*2","cljs.core/*1","e40484","printed","cljs.core/assoc-in","js/console.log","cljs.core/*e","js/shadow.cljs.devtools.client.env.reset-print-fn-ref","shadow.cljs.devtools.client.env/reset-print-fn-ref","shadow.cljs.devtools.client.env/set-print-fns!","msg-fn","original-print-fn","original-print-err-fn","cljs.core/*print-err-fn*","cljs.core/reset!","cljs.core/set-print-fn!","cljs.core/set-print-err-fn!","args","G__40490","clojure.string.join","cljs.core.apply","G__40491","shadow.cljs.devtools.client.env/reset-print-fns!","temp__5735__auto__","x","shadow.cljs.devtools.client.env/async-ops","shadow.cljs.devtools.client.env/repl-queue-ref","js/shadow.cljs.devtools.client.env.repl-queue-arr","shadow.cljs.devtools.client.env/repl-queue-arr","shadow.cljs.devtools.client.env/process-next!","temp__5739__auto__","task","shadow.cljs.devtools.client.env/done!","p__40509","map__40510","cljs.core/PROTOCOL_SENTINEL","cljs.core/hash-map","cljs.core.get","shadow.cljs.devtools.client.env/preprocess-ws-msg","type","msg","G__40523","map__40524","info","warnings","iter__4529__auto__","s__40527","cljs.core/LazySeq","xs__6292__auto__","map__40533","cljs.core/first","iterys__4525__auto__","s__40529","cljs.core/chunked-seq?","c__4527__auto__","size__4528__auto__","cljs.core/count","b__40531","cljs.core/chunk-buffer","i__40530","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__40528","cljs.core/chunk-rest","cljs.core/cons","cljs.core/rest","fs__4526__auto__","cljs.core.concat","iter__40526","resource-name","src","cljs.core/not","warning","cljs.core.distinct","cljs.core.into","shadow.cljs.devtools.client.env/custom-notify-types","shadow.cljs.devtools.client.env/run-custom-notify!","fn","js/goog.getObjectByName","js/$CLJS","cljs.core/fn?","js/console.warn","e40564","js/console.error","shadow.cljs.devtools.client.env/process-ws-msg","text","handler","*default-data-reader-fn*-orig-val__40584","*default-data-reader-fn*-temp-val__40585","cljs.tools.reader/*default-data-reader-fn*","tag","value","e40596","cljs.tools.reader.read_string","p__40604","p__40605","map__40606","map__40608","shadow.cljs.devtools.client.env/make-task-fn","log-missing-fn","log-call-async","log-call","fn-sym","fn-str","async","next","e40618","fn-obj","ex","p__40619","vec__40621","seq__40622","first__40623","cljs.core/next","shadow.cljs.devtools.client.env/do-js-reload*","failure-fn","remaining-tasks","e40628","G__40629","var_args","G__40637","shadow.cljs.devtools.client.env/do-js-reload","p__40639","map__40640","load-code-fn","shadow.cljs.devtools.client.env.do_js_reload","complete-fn","error","remaining","reload-info","load-tasks","p1__40630#","cljs.core.map","cljs.core/reverse","p1__40631#","p__40642","map__40643","shadow.cljs.devtools.client.env/before-load-src","ns","cljs.core._EQ_","seq__40645","chunk__40646","count__40647","i__40648","c__4556__auto__","cljs.core/chunk-first","js/goog.global.SHADOW_NS_RESET","js/shadow.cljs.devtools.client.env.custom-msg-subscribers-ref","shadow.cljs.devtools.client.env/custom-msg-subscribers-ref","shadow.cljs.devtools.client.env/subscribe!","sub-id","callback","shadow.cljs.devtools.client.env/publish!","seq__40651","chunk__40652","count__40653","i__40654","vec__40672","cljs.core.nth","vec__40676","id","e40675","e40679","shadow.cljs.devtools.client.env/goog-is-loaded?","js/$CLJS.SHADOW_ENV.isLoaded","shadow.cljs.devtools.client.env/goog-base-rc","p__40685","map__40686","shadow.cljs.devtools.client.env/src-is-loaded?","resource-id","output-name","or__4126__auto__","shadow.cljs.devtools.client.env/prefilter-sources","sources","cljs.core.filter","p__40705","map__40706","rc","cljs.core.remove","p__40696","map__40698","p__40712","map__40713","shadow.cljs.devtools.client.env/filter-sources-to-get-optimized","compiled","p__40715","map__40716","p__40728","map__40729","shadow.cljs.devtools.client.env/filter-sources-to-get-full","G__40738","vec__40739","seq__40740","first__40741","vec__40773","seq__40774","first__40775","affected","sources-to-get","more","map__40776","deps","provides","should-reload?","cljs.core/some","clojure.set.union","shadow.cljs.devtools.client.env/filter-reload-sources"],"sourcesContent":["(ns shadow.cljs.devtools.client.env\n  (:require\n    [goog.object :as gobj]\n    [clojure.string :as str]\n    [cljs.tools.reader :as reader]\n    [cljs.pprint :refer (pprint)]\n    [clojure.set :as set]))\n\n(defonce active-modules-ref\n  (volatile! #{}))\n\n(defn module-loaded [name]\n  (vswap! active-modules-ref conj (keyword name)))\n\n(defn module-is-active? [module]\n  (contains? @active-modules-ref module))\n\n;; FIXME: make this persistent somehow?\n(defonce runtime-id (str (random-uuid)))\n\n(goog-define enabled false)\n\n(goog-define autoload true)\n\n(goog-define module-format \"goog\")\n\n(goog-define reload-with-state false)\n\n(goog-define build-id \"\")\n\n(goog-define proc-id \"\")\n\n(goog-define server-host \"\")\n\n(goog-define server-port 8200)\n\n(goog-define repl-pprint false)\n\n(goog-define use-document-host true)\n\n(goog-define devtools-url \"\")\n\n(goog-define reload-strategy \"optimized\")\n\n(goog-define ssl false)\n\n(goog-define ignore-warnings false)\n\n(goog-define log-style \"font-weight: bold;\")\n\n(goog-define custom-notify-fn \"\")\n\n(defn devtools-info []\n  #js {:server_port server-port\n       :server_host server-host\n       :build_id build-id\n       :proc_id proc-id\n       :runtime_id runtime-id\n       :ssl ssl})\n\n(defn get-server-host []\n  (cond\n    (and use-document-host\n         js/goog.global.document\n         js/goog.global.document.location\n         (seq js/goog.global.document.location.hostname))\n    js/document.location.hostname\n\n    (seq server-host)\n    server-host\n\n    :else\n    \"localhost\"))\n\n(defn get-url-base []\n  (if (seq devtools-url)\n    devtools-url\n    (str \"http\" (when ssl \"s\") \"://\" (get-server-host) \":\" server-port)))\n\n(defn get-ws-url-base []\n  (-> (get-url-base)\n      (str/replace #\"^http\" \"ws\")))\n\n(defn ws-url [runtime-type]\n  {:pre [(keyword? runtime-type)]}\n  (str (get-ws-url-base) \"/ws/worker/\" build-id \"/\" proc-id \"/\" runtime-id \"/\" (name runtime-type)))\n\n(defn ws-listener-url [client-type]\n  (str (get-ws-url-base) \"/ws/listener/\" build-id \"/\" proc-id \"/\" runtime-id))\n\n(defn files-url []\n  (str (get-url-base) \"/worker/files/\" build-id \"/\" proc-id \"/\" runtime-id))\n\n(def repl-print-fn\n  (if-not repl-pprint\n    pr-str\n    (fn repl-pprint [obj]\n      (with-out-str\n        (pprint obj)\n        ))))\n\n(defn repl-error [e]\n  (-> {:type :repl/invoke-error\n       ;; FIXME: may contain non-printable things and would break the client read\n       ;; :ex-data (ex-data e)\n       :error (.-message e)}\n      (cond->\n        (.hasOwnProperty e \"stack\")\n        (assoc :stack (.-stack e)))))\n\n(defonce repl-results-ref (atom {}))\n\n(defn repl-call [repl-expr repl-error]\n  (try\n    (let [result-id (str (random-uuid))\n          result {:type :repl/result\n                  :result-id result-id}\n\n          start (js/Date.now)\n          ret (repl-expr)\n          runtime (- (js/Date.now) start)]\n\n      ;; FIXME: this needs some kind of GC, shouldn't keep every single result forever\n      (swap! repl-results-ref assoc result-id {:timestamp (js/Date.now)\n                                               :result ret})\n\n      ;; FIXME: these are nonsense with multiple sessions. refactor this properly\n      (set! *3 *2)\n      (set! *2 *1)\n      (set! *1 ret)\n\n      (try\n        (let [printed (repl-print-fn ret)]\n          (swap! repl-results-ref assoc-in [result-id :printed] printed)\n          (assoc result :value printed :ms runtime))\n        (catch :default e\n          (js/console.log \"encoding of result failed\" e ret)\n          (assoc result :error \"ENCODING FAILED, check host console\"))))\n    (catch :default e\n      (set! *e e)\n      (repl-error e)\n      )))\n\n;; FIXME: this need to become idempotent somehow\n;; but is something sets a print-fn we can't tell if that\n;; will actually call ours. only a problem if the websocket is\n;; reconnected though\n(defonce reset-print-fn-ref (atom nil))\n\n(defn set-print-fns! [msg-fn]\n  ;; cannot capture these before as they may change in between loading this file\n  ;; and running the websocket connect. the user code is loaded after this file\n  (let [original-print-fn cljs.core/*print-fn*\n        original-print-err-fn cljs.core/*print-err-fn*]\n\n    (reset! reset-print-fn-ref\n      (fn reset-print-fns! []\n        (set-print-fn! original-print-fn)\n        (set-print-err-fn! original-print-err-fn)))\n\n    (set-print-fn!\n      (fn repl-print-fn [& args]\n        (msg-fn {:type :repl/out :text (str/join \"\" args)})\n        (when original-print-fn\n          (apply original-print-fn args))))\n\n    (set-print-err-fn!\n      (fn repl-print-err-fn [& args]\n        (msg-fn {:type :repl/err :text (str/join \"\" args)})\n        (when original-print-err-fn\n          (apply original-print-err-fn args))))))\n\n(defn reset-print-fns! []\n  (when-let [x @reset-print-fn-ref]\n    (x)\n    (reset! reset-print-fn-ref nil)))\n\n(def async-ops #{:repl/require :repl/init :repl/session-start})\n\n(def repl-queue-ref (atom false))\n(defonce repl-queue-arr (array))\n\n(defn process-next! []\n  (when-not @repl-queue-ref\n    (when-some [task (.shift repl-queue-arr)]\n      (reset! repl-queue-ref true)\n      (task))))\n\n(defn done! []\n  (reset! repl-queue-ref false)\n  (process-next!))\n\n;; do work that all client impls would share here instead of repeating the code\n(defn preprocess-ws-msg [{:keys [type] :as msg}]\n  (case type\n    :build-completed\n    (let [{:keys [info]} msg\n\n          warnings\n          (->> (for [{:keys [resource-name warnings] :as src} (:sources info)\n                     :when (not (:from-jar src))\n                     warning warnings]\n                 (assoc warning :resource-name resource-name))\n               (distinct)\n               (into []))]\n      (assoc-in msg [:info :warnings] warnings))\n\n    msg))\n\n(def custom-notify-types\n  #{:build-complete\n    :build-failure\n    :build-init\n    :build-start})\n\n(defn run-custom-notify! [msg]\n  (when (seq custom-notify-fn)\n    ;; look up every time it case it gets reloaded\n    (let [fn (js/goog.getObjectByName custom-notify-fn js/$CLJS)]\n      (if-not (fn? fn)\n        (js/console.warn \"couldn't find custom :build-notify\" custom-notify-fn)\n        (try\n          (fn msg)\n          (catch :default e\n            (js/console.error \"Failed to run custom :build-notify\" custom-notify-fn)\n            (js/console.error e))))))\n  (done!))\n\n(defn process-ws-msg [text handler]\n  (binding [reader/*default-data-reader-fn*\n            (fn [tag value]\n              [:tagged-literal tag value])]\n    (try\n      (let [msg (-> text (reader/read-string) (preprocess-ws-msg))]\n        (.push repl-queue-arr #(handler msg done!))\n        ;; ensure custom notify is called after the message is handled by shadow-cljs itself\n        ;; FIXME: :build-complete isn't actually treated as async so this runs before the code is reloaded\n        ;; only actually an issue when reloading the ns that has the notify-fn since the old one will be called\n        (when (contains? custom-notify-types (:type msg))\n          (.push repl-queue-arr #(run-custom-notify! msg))))\n      (process-next!)\n      (catch :default e\n        (js/console.warn \"failed to parse websocket message\" text e)\n        (throw e)))))\n\n(defn make-task-fn [{:keys [log-missing-fn log-call-async log-call]} {:keys [fn-sym fn-str async]}]\n  (fn [next]\n    (try\n      (let [fn-obj (js/goog.getObjectByName fn-str js/$CLJS)]\n        (cond\n          (nil? fn-obj)\n          (do (when log-missing-fn\n                (log-missing-fn fn-sym))\n              (next))\n\n          async\n          (do (when log-call-async\n                (log-call-async fn-sym))\n              (fn-obj next))\n\n          :else\n          (do (when log-call\n                (log-call fn-sym))\n              (fn-obj)\n              (next))))\n      (catch :default ex\n        (js/console.warn \"error when calling lifecycle function\" (str fn-sym) ex)\n        (next)))))\n\n(defn do-js-reload* [failure-fn [task & remaining-tasks]]\n  (when task\n    (try\n      (task #(do-js-reload* failure-fn remaining-tasks))\n      (catch :default e\n        (failure-fn e task remaining-tasks)))))\n\n(defn do-js-reload\n  \"should pass the :build-complete message and an additional callback\n   which performs the actual loading of the code (sync)\n   will call all before/after callbacks in order\"\n  ([msg load-code-fn]\n   (do-js-reload\n     msg\n     load-code-fn\n     (fn [])))\n  ([msg load-code-fn complete-fn]\n   (do-js-reload\n     msg\n     load-code-fn\n     complete-fn\n     (fn [error task remaining]\n       (js/console.warn \"JS reload failed\" error))))\n  ([{:keys [reload-info] :as msg} load-code-fn complete-fn failure-fn]\n   (let [load-tasks\n         (-> []\n             ;; unload is FILO\n             (into (->> (:before-load reload-info)\n                        (map #(make-task-fn msg %))\n                        (reverse)))\n             (conj (fn [next]\n                     (load-code-fn)\n                     (next)))\n             ;; load is FIFO\n             (into (map #(make-task-fn msg %)) (:after-load reload-info))\n             (conj (fn [next]\n                     (complete-fn)\n                     (next))))]\n\n     (do-js-reload* failure-fn load-tasks))))\n\n(defn before-load-src [{:keys [type ns] :as src}]\n  (when (= :cljs type)\n    (doseq [x js/goog.global.SHADOW_NS_RESET]\n      (x ns))))\n\n(defonce custom-msg-subscribers-ref (atom {}))\n\n(defn subscribe! [sub-id callback]\n  (swap! custom-msg-subscribers-ref assoc sub-id callback))\n\n(defn publish! [msg]\n  (doseq [[id callback] @custom-msg-subscribers-ref]\n    (try\n      (callback msg)\n      (catch :default e\n        (js/console.warn \"failed to handle custom msg\" id msg)))))\n\n(defn goog-is-loaded? [name]\n  (js/$CLJS.SHADOW_ENV.isLoaded name))\n\n(def goog-base-rc\n  [:shadow.build.classpath/resource \"goog/base.js\"])\n\n(defn src-is-loaded? [{:keys [resource-id output-name] :as src}]\n  ;; FIXME: don't like this special case handling, but goog/base.js will always be loaded\n  ;; but not as a separate file\n  (or (= goog-base-rc resource-id)\n      (goog-is-loaded? output-name)))\n\n(defn prefilter-sources [reload-info sources]\n  (->> sources\n       (filter\n         (fn [{:keys [module] :as rc}]\n           (or (= \"js\" module-format)\n               (module-is-active? module))))\n       ;; don't reload namespaces that have ^:dev/never-reload meta\n       (remove (fn [{:keys [ns]}]\n                 (contains? (:never-load reload-info) ns)))))\n\n(defn filter-sources-to-get-optimized [{:keys [sources compiled] :as info} reload-info]\n  (->> sources\n       (prefilter-sources reload-info)\n       (filter\n         (fn [{:keys [ns resource-id] :as src}]\n           (or (contains? (:always-load reload-info) ns)\n               (not (src-is-loaded? src))\n               (and (contains? compiled resource-id)\n                    ;; never reload files from jar\n                    ;; they can't be hot-swapped so the only way they get re-compiled\n                    ;; is if they have warnings, which we can't to anything about\n                    (not (:from-jar src))))))\n       (into [])))\n\n(defn filter-sources-to-get-full [{:keys [sources compiled] :as info} reload-info]\n  (loop [affected #{}\n         sources-to-get []\n         [src & more] (prefilter-sources reload-info sources)]\n\n    (if-not src\n      sources-to-get\n      (let [{:keys [ns resource-id deps provides]}\n            src\n\n            should-reload?\n            (or (contains? (:always-load reload-info) ns)\n                ;; always load sources that haven't been loaded yet\n                ;; this fixes issues where a namespace is added to a build that has\n                ;; dependencies that haven't been loaded yet but were compiled before\n                (not (src-is-loaded? src))\n                (and (or (contains? compiled resource-id)\n                         (some affected deps))\n                     ;; never reload files from jar\n                     ;; they can't be hot-swapped so the only way they get re-compiled\n                     ;; is if they have warnings, which we can't to anything about\n                     (not (:from-jar src))))]\n\n        (if-not should-reload?\n          (recur affected sources-to-get more)\n          (recur\n            (set/union affected provides)\n            (conj sources-to-get src)\n            more))))))\n\n(defn filter-reload-sources [info reload-info]\n  (if (= \"full\" reload-strategy)\n    (filter-sources-to-get-full info reload-info)\n    (filter-sources-to-get-optimized info reload-info)))"]}